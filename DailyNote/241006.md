# AWS VPN 종류 및 S2S VPN 정리
---
## VPN 조사
- AWS VPN  
	- AWS에서 제공하는 VPN
		- Direct Connect
		- Site-to-Site VPN
		- 클라이언트 VPN
	- 별도 VPN (OpenSwan 등)
		- 사용자가 인스턴스 기반의 VPN을 직접 구성해야한다.

## AWS Site-to-Site VPN (S2S VPN)
- AWS에서 관리형 서비스로 제공하는 VPN
- 두 개의 네트워크 도메인이 가상의 사설 네트워크 연결을 사용하여 프라이빗 통신을 제공
- 표준 IPsec VPN만 지원
- 기본적으로 고가용성 아키텍처를 제공한다.
	- VPN 연결 생성 시, 2개의 터널 엔드포인트는 고가용성을 위해 서로 다른 가용 영역에 생성된다.
	- 따라서, 고가용성을 위해, 두 개의 터널엔드포인트와 각각 터널을 구성하여 터널 이중화하는 것을 권장한다.
- 관련 용어
	- VPN 연결
		- 온프레미스의 장비와 AWS VPC 간의 보안 연결
	- VPN 터널
		- AWS VPC 네트워크와 온프레미스 네트워크 간 주고받을 수 있는 암호화된 링크
	- 가상 프라이빗 게이트웨이 (Virtual Private Gateway, VGW)
		- AWS의 관리형 S2S VPN의 게이트웨이
	- 고객 게이트웨이 (Custom Gateway, CGW)
		- 온프레미스의 장비 정보를 지정한다.
		- AWS의 가상 프라이빗 게이트웨이와 VPN 연결 설정을 위해 필요한 IPsec 정보를 지정한다.
	- 고객 게이트웨이 디바이스
		- 온프레미스의 장비 혹은 SW 애플리케이션을 말한다.
- VPN 특징
	- VPN 터널의 Idle Timout
		- VPN 터널 연결 후, 터널에 트래픽이 10초 이상 흐르지 않는 경우 해당 터널은 Down 된다.
		- 터널 유지를 위해 온프레미스에서 DPD (Dead Peer Detect) 를 설정하거나 Ping을 일정 간격으로 발생시켜 터널을 유지시키는 것을 권장한다.
		- DPD 시간 초과 발생 시, AWS가 세션을 다시 시작하거나 작업을 수행하지 않도록 지정이 가능하다.
- VPN 라우팅 옵션
	- Static Routing
		- 사용자가 직접 원격 네트워크의 경로에 대해서 설정
	- Dynamic Routing
		- BGP 라우팅 프로토콜을 사용하여, 상대방으로부터 전달되는 네트워크 경로를 자동으로 인지하여 통신 가능
		- 네트워크 정보를 필요할 때마다 수동으로 설정할 필요 없이, 동적으로 네트워크 정보를 관리할 수 있는 이점 존재
	- VPC 라우팅 테이블의 경로 전파 옵션을 '활성화'하면,
	  라우팅 테이블을 수정하지 않고, VGW에 의해 전파되는 경로가 라우팅 테이블에 동적으로 업데이트 할 수 있다. 